<!doctype html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="cache-control" content="max-age=0" />
  <meta http-equiv="cache-control" content="no-cache" />  
  <meta http-equiv="expires" content="0" />
  <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
  <meta http-equiv="pragma" content="no-cache" />
  <title>AcademyApp</title>
  <meta name="description" content="AcademyApp">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/styles.css">
  <script type="text/javascript" src="https://www.parsecdn.com/js/parse-1.3.1.min.js"></script> 
 <!-- <script src="https://sdk.amazonaws.com/js/aws-sdk-2.0.22.min.js"></script> -->

</head>

<body>

  <div class="row">
      <div>
        <a href="signup.html">SIGN-UP</a>
        <a href="signin.html">SIGN-IN</a>
        <a href="createClass.html">CREATE_CLASS</a>
        <a href="event_list.html">EVENT_LIST</a>
        <a href="editMember.html">MEMBER_EDIT</a>
      </div>
  </div>
  <hr/> 

  <div id="main">

    <h1>The Way Taekwondo - FBCO</h1>
    <h3>Create Class Form</h3>

   <!--  <div>
      form asking for date/Type/hours/location/description
    </div>
 -->
    <div class="row">
        <div class="span1">Date:</div>
        <div class="span1"><input id="txtDate" type="datetime-local"></div>
    </div>

    <div class="row">
      <div class="span1">Type:</div>
      <div class="span1">
       <select id="type">
        <option value="FUNDAMENTALS CLASS">FUNDAMENTALS CLASS</option>
        <option value="ADVANCED CLASS">ADVANCED CLASS</option>
        <option value="BLACKBELT CLASS">BLACKBELT CLASS</option>
        <option value="INTERNAL TOURNAMENT">INTERNAL TOURNAMENT</option>
        <option value="TOURNAMENT">TOURNAMENT</option>
        <option value="SOCIAL SERVICE">SOCIAL SERVICE</option>
       </select>
      </div>
    </div>

    <div class="row">
      <div class="span1">Duration (Hours):</div>
      <div class="span1"><input name="hours" id="hours" type="text"></div>
    </div>
  
    <div class="row">
      <div class="span1">Location:</div>
      <div class="span1"><input name="location" id="location" type="text"></div>
    </div>

  
    <div class="row">
      <div ><button onclick="createEvt()">Save</button><button onclick="reset()">Reset</button></div>
    </row>

    <div><hr/>
      <div class="row" id="msg"></div>
      <hr/></div>
  </div>
</body>
  <script src="js/jquery-2.1.0.min.js"></script>
  <script src="js/setnow.jquery.js"></script>
  <script src="js/date.js"></script>
  <script type="text/javascript">
    Parse.initialize("qhJKJHGivO5op9dvRGxYXNr7Xjx3ru3hpDKXw9G0", "Xyov0zQSe7syEvlMgkUdUmKlQ1S9eQcq485MEqaG");
    var today = new Date();
    $("#txtDate").setNow(true);

    function logout(){
     Parse.User.logOut();
    }

    function createEvt(){
      if($("#location").val().length < 2 || $("#txtDate").val().length < 1 || $("#hours").val().length < 1){
        showMsg("Please complete all the fields", "err");
      }else{
          showMsg("Creating Event...");
          var Event = Parse.Object.extend("Event");
          var event = new Event();

          var dateString = $("#txtDate").val();
          if( dateString.length == 16){
            dateString = dateString + ":00";
          }
          // console.log( test );

          var evtDate =  Date.parse( dateString );
          event.save({hours: parseInt($( "#hours" ).val()), location: $( "#location" ).val().toUpperCase(), 
            Type: $( "#type" ).val(), date: evtDate, academyid: "1"
          }, {
                success: function(object) {
                  // $(".success").show();
                  reset();
                  // alert("Event created");
                  // $.notify("Event Created", "success");
                  showMsg("Event created!", "");
                  reset();
                },
                error: function(model, error) {
                  // $(".error").show();
                  // alert(error.message);
                  showMsg(error.message, "err");
                }}); 
      }
    }

    function reset(){
      $("#hours").val("");
      $("#location").val("");
    }

    var currentUser = Parse.User.current();

    if (!currentUser) {
      window.location.href = "index.html"
    }

    // Numeric only control handler
    jQuery.fn.ForceNumericOnly =
    function()
    {
        return this.each(function()
        {
            $(this).keydown(function(e)
            {
                var key = e.charCode || e.keyCode || 0;
                // allow backspace, tab, delete, enter, arrows, numbers and keypad numbers ONLY
                // home, end, period, and numpad decimal
                return (
                    key == 8 || 
                    key == 9 ||
                    key == 13 ||
                    key == 46 ||
                    key == 110 ||
                    key == 190 ||
                    (key >= 35 && key <= 40) ||
                    (key >= 48 && key <= 57) ||
                    (key >= 96 && key <= 105));
            });
        });
    };

  function showMsg(message, type){
    $("#msg").empty();
    msgStyle = "color:black; font-weight:bold;";
    if(type == "err"){
      msgStyle = "color:red; font-weight:bold;";
    }
    $("#msg").append("<p style='"+msgStyle+"'>"+message+"</p>");
  }

    $("#hours").ForceNumericOnly();

  </script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/notify.min.js"></script>
</html>
